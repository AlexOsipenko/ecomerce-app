{"version":3,"sources":["panels/Items.js","panels/Item.js","App.js","index.js"],"names":["Items","_this","this","_this$props","props","id","items","react_default","a","createElement","vkui","length","map","item","index","key","data-to","onClick","e","go","itemId","before","alt","style","width","height","margin","src","thumb_photo","multiline","description","title","price","amount","currency","name","React","Component","Item","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","slideIndex","imageHeight","_this2","marginBottom","left","back_default","text","photos","slideWidth","textAlign","bullets","photo","backgroundColor","maxHeight","sizes","url","vertical","size","level","App","object","activePanel","currentTarget","dataset","to","setState","connect","send","location","getItems","concat","getInfoItem","authToken","window","hash","replace","subscribe","detail","type","data","access_token","getLocationHash","indexOf","request_id","response","console","log","app_id","scope","method","params","owner_id","v","item_ids","extended","panels_Items","panels_Item","addEventListener","preventDefault","history","pushState","newURL","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.c3c5cdb9.chunk.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Panel, Cell, List, PanelHeader, Group, Div } from '@vkontakte/vkui';\n\nclass Items extends React.Component {\n\trender() {\n\t\tlet { \n\t\t\tid, items \n\t\t} = this.props\n\n\t\treturn (\n\t\t\t<Panel id={id}>\n\t\t\t\t<PanelHeader>Товары</PanelHeader>\n\t\t\t\t<Group>\n\t\t\t\t\t<List>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titems.length > 0 && items.map((item, index) => (\n\t\t\t\t\t\t\t\t<Cell \n\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\tdata-to=\"item\" \n\t\t\t\t\t\t\t\t\tonClick={(e) => this.props.go(e, { itemId : item.id })}\n\t\t\t\t\t\t\t\t\tbefore={\n\t\t\t\t\t\t\t\t\t\t<img \n\t\t\t\t\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t\t\t\t\t\t\tstyle={{ \n\t\t\t\t\t\t\t\t\t\t\t\twidth: 40, \n\t\t\t\t\t\t\t\t\t\t\t\theight : 40, \n\t\t\t\t\t\t\t\t\t\t\t\tmargin : 10 \n\t\t\t\t\t\t\t\t\t\t\t}} \n\t\t\t\t\t\t\t\t\t\t\tsrc={item.thumb_photo}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tmultiline\n\t\t\t\t\t\t\t\t\tdescription={item.description}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{item.title}, {item.price.amount} {item.price.currency.name}\n\t\t\t\t\t\t\t\t</Cell>\n\t\t\t\t\t\t\t))\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titems.length === 0 &&\n\t\t\t\t\t\t\t<Div>\n\t\t\t\t\t\t\t\tХм, но мы не нашли товаров.\n\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t}\n\t\t\t\t\t</List>\n\t\t\t\t</Group>\n\t\t\t</Panel>\n\t\t);\n\t}\n}\n\nItems.propTypes = {\n\tid: PropTypes.string.isRequired\n};\n\nexport default Items;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Panel, PanelHeader, FixedLayout, Button, Div, Header, Gallery, Group, HeaderButton } from '@vkontakte/vkui';\nimport Icon24Back from '@vkontakte/icons/dist/24/back'\n\nclass Item extends React.Component {\n\tconstructor(props) {\n        super(props);\n        \n        this.state = {\n            slideIndex: 0,\n            imageHeight : 350\n        }\n    }\n    \n\trender() {\n        let { id, item } = this.props\n\n\t\treturn (\n            <Panel id={id} style={{ marginBottom : 100 }}>\n            {\n                item !== null &&\n                <div>\n                    <PanelHeader \n                        left={<HeaderButton data-to=\"items\" onClick={(e) => this.props.go(e)}><Icon24Back/></HeaderButton>}\n                    >Товар</PanelHeader>\n                    <Header>{item.title} <b>{item.price.text}</b></Header>\n                    { \n                        item.photos.length > 0 && \n                        (\n                            <Gallery\n                                slideWidth=\"100%\"\n                                style={{ height: this.state.imageHeight, textAlign : 'center' }}\n                                bullets=\"dark\"\n                            >\n                                { \n                                    item.photos.map((photo, index) => (\n                                        <div key={index} style={{width: '100%', height : '100%', backgroundColor : '#fff'}}>\n                                            <img \n                                                alt=\"\"\n                                                style={{  \n                                                    maxHeight : this.state.imageHeight\n                                                }} src={photo.sizes[photo.sizes.length - 1].url}>\n                                            </img>\n                                        </div>\n                                    ))\n                                }\n                            </Gallery>\n                        )\n                    }\n                    {\n                        item.photos.length === 0 &&\n                        (\n                            <Gallery\n                                slideWidth=\"100%\"\n                                style={{ height: this.state.imageHeight, textAlign : 'center' }}\n                            >\n                                <div style={{width: '100%', height : '100%', backgroundColor : '#fff'}}>\n                                    <img \n                                        alt=\"\"\n                                        style={{  \n                                            maxHeight : '350px'\n                                        }} src={item.thumb_photo}></img>\n                                </div>\n                            </Gallery>\n                        )\n                    }\n                    <Group>\n                        <Div>\n                            {item.description}\n                        </Div>\n                    </Group>\n                    <FixedLayout vertical=\"bottom\">\n                        <Div>\n                            <Button size=\"xl\" level=\"commerce\">Купить</Button>\n                        </Div>\n                    </FixedLayout>\n                </div>\n            }\n            {\n                item == null &&\n                <div>\n                    <PanelHeader \n                        left={<HeaderButton data-to=\"items\" onClick={(e) => this.props.go(e)}><Icon24Back/></HeaderButton>}\n                    >Товар</PanelHeader>\n                    <Group>\n                        <Div>\n                            Хм, но мы не нашли товар.\n                        </Div>\n                    </Group>\n                </div>\n            }\n            </Panel>\n\t\t);\n\t}\n}\n\nItem.propTypes = {\n    id: PropTypes.string.isRequired,\n};\n\nexport default Item;\n","import React from 'react';\nimport connect from '@vkontakte/vkui-connect'; //@vkontakte/vkui-connect-mock - для отладки\nimport { View } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport Items from './panels/Items';\nimport Item from './panels/Item';\n\nclass App extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tactivePanel : 'items',\n\t\t\tauthToken : null,\n\t\t\titems : [],\n\t\t\titem : null\n\t\t};\n\t}\n\n\tgetLocationHash() {\n\t\treturn window.location.hash.replace('#','')\n\t}\n\n\n\t\n\n\tcomponentWillMount() {\n\t\tconnect.subscribe((e) => {\n\t\t\tswitch (e.detail.type) {\n\t\t\t\tcase 'VKWebAppAccessTokenReceived':\n\t\t\t\t\tthis.setState({ authToken : e.detail.data.access_token }, function() {\n\t\t\t\t\t\tlet hash = this.getLocationHash()\n\t\t\t\t\t\tif (hash === 'items') {\n\t\t\t\t\t\t\tthis.setState({ activePanel : 'items' }, function() { this.getItems() })\n\t\t\t\t\t\t} else if (hash.indexOf('item') !== -1) {\n\t\t\t\t\t\t\tlet id = hash.replace('item','')\n\t\t\t\t\t\t\tthis.setState({ activePanel : 'item' }, function() { this.getInfoItem(id) })\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.setState({ activePanel : 'items' }, function() { this.getItems() })\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'VKWebAppCallAPIMethodResult':\n\t\t\t\t\tif (e.detail.data.request_id === 1234567) {\n\t\t\t\t\t\tthis.setState({ items : e.detail.data.response.items })\n\t\t\t\t\t}\n\t\t\t\t\tif (e.detail.data.request_id === 123) {\n\t\t\t\t\t\tthis.setState({ item : e.detail.data.response.items[0] })\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.log(e.detail.type);\n\t\t\t}\n\t\t});\n\t\tconnect.send(\"VKWebAppGetAuthToken\", {\"app_id\": 6906999, \"scope\": \"market\"});\n\t}\n\n\tgetItems() {\n\t\tconsole.log(this.state)\n\t\tconst ownerId = -124527492\n\t\tconnect.send(\"VKWebAppCallAPIMethod\", {\"method\": \"market.get\", \"request_id\" : 1234567, \"params\": {\"owner_id\": ownerId , \"v\":\"5.92\", \"access_token\": this.state.authToken }});\n\t}\n\n\tgetInfoItem(id) {\n\t\tconst ownerId = -124527492\n\t\tlet itemId = `${ownerId}_${id}`\n\t\tconnect.send(\"VKWebAppCallAPIMethod\", {\"method\": \"market.getById\", \"request_id\" : 123,  \"params\": {\"item_ids\": itemId , \"v\":\"5.92\", \"extended\" : 1,  \"access_token\": this.state.authToken }});\n\t}\n\n\tgo = (e, object) => {\n\t\tlet activePanel = e.currentTarget.dataset.to\n\t\tthis.setState({ activePanel : activePanel })\n\t\tif (activePanel === 'items') {\n\t\t\tconnect.send(\"VKWebAppSetLocation\", {\"location\": \"items\"});\n\t\t\tthis.getItems()\n\t\t}\n\t\tif (activePanel === 'item') {\n\t\t\tconnect.send(\"VKWebAppSetLocation\", {\"location\": `item${object.itemId}`});\n\t\t\tthis.getInfoItem(object.itemId)\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<View activePanel={this.state.activePanel}>\n\t\t\t\t<Items \n\t\t\t\t\tid=\"items\" \n\t\t\t\t\titems={this.state.items}\n\t\t\t\t\tgo={this.go}\n\t\t\t\t/>\n\t\t\t\t<Item \n\t\t\t\t\tid=\"item\"\n\t\t\t\t\titem={this.state.item}\n\t\t\t\t\tgo={this.go}\n\t\t\t\t/>\n\t\t\t</View>\n\t\t);\n\t}\n}\n\nexport default App;\n","import 'core-js/es6/map';\nimport 'core-js/es6/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport connect from '@vkontakte/vkui-connect';\nimport App from './App';\n// import registerServiceWorker from './sw';\n\n// Init VK App\nconnect.send('VKWebAppInit', {});\n\n// Если вы хотите, чтобы ваше веб-приложение работало в оффлайне и загружалось быстрее,\n// расскомментируйте строку с registerServiceWorker();\n// Но не забывайте, что на данный момент у технологии есть достаточно подводных камней\n// Подробнее про сервис воркеры можно почитать тут — https://vk.cc/8MHpmT \n// registerServiceWorker();\n\nconsole.log(123)\nwindow.addEventListener(\"hashchange\", function(e) {\n    console.log(e)\n    e.preventDefault()\n    window.history.pushState({},1, e.newURL)\n}, false);\n\nReactDOM.render(\n    <App />\n    , document.getElementById('root'));\n"],"sourceRoot":""}