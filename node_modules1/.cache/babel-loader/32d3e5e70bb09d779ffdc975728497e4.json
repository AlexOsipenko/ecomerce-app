{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\yokum\\\\Documents\\\\GitHub\\\\vkAppPay\\\\ecomerce-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\yokum\\\\Documents\\\\GitHub\\\\vkAppPay\\\\ecomerce-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\yokum\\\\Documents\\\\GitHub\\\\vkAppPay\\\\ecomerce-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\yokum\\\\Documents\\\\GitHub\\\\vkAppPay\\\\ecomerce-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\yokum\\\\Documents\\\\GitHub\\\\vkAppPay\\\\ecomerce-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\yokum\\\\Documents\\\\GitHub\\\\vkAppPay\\\\ecomerce-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\yokum\\\\Documents\\\\GitHub\\\\vkAppPay\\\\ecomerce-app\\\\src\\\\App.js\";\nimport React from 'react';\nimport connect from '@vkontakte/vkui-connect';\nimport { View } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport fetchJsonp from 'fetch-jsonp';\nimport Home from './panels/Home';\n\nvar App = /*#__PURE__*/function (_React$Component) {\n  _inherits(App, _React$Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.go = function (e) {\n      _this.setState({\n        activePanel: e.currentTarget.dataset.to\n      });\n    };\n\n    _this.state = {\n      activePanel: 'home',\n      fetchedUser: null,\n      authToken: null,\n      items: []\n    };\n    _this.getItems = _this.getItems.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      connect.subscribe(function (e) {\n        switch (e.detail.type) {\n          case 'VKWebAppGetUserInfoResult':\n            _this2.setState({\n              fetchedUser: e.detail.data\n            });\n\n            break;\n\n          case 'VKWebAppAccessTokenReceived':\n            _this2.setState({\n              authToken: e.detail.data.access_token\n            });\n\n            _this2.getItems();\n\n            break;\n\n          default:\n            console.log(e.detail.type);\n        }\n      });\n      connect.send('VKWebAppGetUserInfo', {});\n      connect.send(\"VKWebAppGetAuthToken\", {\n        \"app_id\": 6906999,\n        \"scope\": \"market\"\n      });\n    }\n  }, {\n    key: \"getItems\",\n    value: function getItems() {\n      var _this3 = this;\n\n      var ownerId = 124527492;\n      var api = \"https://api.vk.com/method/market.get?v=5.52&access_token=\".concat(this.state.authToken, \"&owner_id=-\").concat(ownerId);\n      fetchJsonp(api).then(function (res) {\n        return res.json();\n      }).then(function (data) {\n        return _this3.setState({\n          items: data.response.items\n        });\n      }).catch(function (e) {\n        return [];\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(View, {\n        activePanel: this.state.activePanel,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 4\n        }\n      }, /*#__PURE__*/React.createElement(Home, {\n        id: \"home\",\n        items: this.state.items,\n        fetchedUser: this.state.fetchedUser,\n        go: this.go,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 5\n        }\n      }));\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nexport default App;","map":{"version":3,"sources":["C:/Users/yokum/Documents/GitHub/vkAppPay/ecomerce-app/src/App.js"],"names":["React","connect","View","fetchJsonp","Home","App","props","go","e","setState","activePanel","currentTarget","dataset","to","state","fetchedUser","authToken","items","getItems","bind","subscribe","detail","type","data","access_token","console","log","send","ownerId","api","then","res","json","response","catch","Component"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,OAAP,MAAoB,yBAApB;AACA,SAASC,IAAT,QAAqB,iBAArB;AACA,OAAO,+BAAP;AACA,OAAOC,UAAP,MAAuB,aAAvB;AACA,OAAOC,IAAP,MAAiB,eAAjB;;IAEMC,G;;;AACL,eAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AAClB,6EAAMA,KAAN;;AADkB,UA+BnBC,EA/BmB,GA+Bd,UAACC,CAAD,EAAO;AACX,YAAKC,QAAL,CAAc;AAAEC,QAAAA,WAAW,EAAEF,CAAC,CAACG,aAAF,CAAgBC,OAAhB,CAAwBC;AAAvC,OAAd;AACA,KAjCkB;;AAGlB,UAAKC,KAAL,GAAa;AACZJ,MAAAA,WAAW,EAAE,MADD;AAEZK,MAAAA,WAAW,EAAE,IAFD;AAGZC,MAAAA,SAAS,EAAG,IAHA;AAIZC,MAAAA,KAAK,EAAG;AAJI,KAAb;AAOA,UAAKC,QAAL,GAAgB,MAAKA,QAAL,CAAcC,IAAd,uDAAhB;AAVkB;AAWlB;;;;wCAEmB;AAAA;;AACnBlB,MAAAA,OAAO,CAACmB,SAAR,CAAkB,UAACZ,CAAD,EAAO;AACxB,gBAAQA,CAAC,CAACa,MAAF,CAASC,IAAjB;AACC,eAAK,2BAAL;AACC,YAAA,MAAI,CAACb,QAAL,CAAc;AAAEM,cAAAA,WAAW,EAAEP,CAAC,CAACa,MAAF,CAASE;AAAxB,aAAd;;AACA;;AACD,eAAK,6BAAL;AACC,YAAA,MAAI,CAACd,QAAL,CAAc;AAAEO,cAAAA,SAAS,EAAGR,CAAC,CAACa,MAAF,CAASE,IAAT,CAAcC;AAA5B,aAAd;;AACA,YAAA,MAAI,CAACN,QAAL;;AACA;;AACD;AACCO,YAAAA,OAAO,CAACC,GAAR,CAAYlB,CAAC,CAACa,MAAF,CAASC,IAArB;AATF;AAWA,OAZD;AAaArB,MAAAA,OAAO,CAAC0B,IAAR,CAAa,qBAAb,EAAoC,EAApC;AACA1B,MAAAA,OAAO,CAAC0B,IAAR,CAAa,sBAAb,EAAqC;AAAC,kBAAU,OAAX;AAAoB,iBAAS;AAA7B,OAArC;AACA;;;+BAMU;AAAA;;AACV,UAAMC,OAAO,GAAG,SAAhB;AACA,UAAIC,GAAG,sEAA+D,KAAKf,KAAL,CAAWE,SAA1E,wBAAiGY,OAAjG,CAAP;AACAzB,MAAAA,UAAU,CAAC0B,GAAD,CAAV,CACCC,IADD,CACM,UAAAC,GAAG;AAAA,eAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,OADT,EAECF,IAFD,CAEM,UAAAP,IAAI;AAAA,eAAI,MAAI,CAACd,QAAL,CAAc;AAAEQ,UAAAA,KAAK,EAAGM,IAAI,CAACU,QAAL,CAAchB;AAAxB,SAAd,CAAJ;AAAA,OAFV,EAGCiB,KAHD,CAGO,UAAA1B,CAAC;AAAA,eAAI,EAAJ;AAAA,OAHR;AAIA;;;6BAEQ;AACR,0BACC,oBAAC,IAAD;AAAM,QAAA,WAAW,EAAE,KAAKM,KAAL,CAAWJ,WAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACC,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAC,MAAT;AAAgB,QAAA,KAAK,EAAE,KAAKI,KAAL,CAAWG,KAAlC;AAAyC,QAAA,WAAW,EAAE,KAAKH,KAAL,CAAWC,WAAjE;AAA8E,QAAA,EAAE,EAAE,KAAKR,EAAvF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADD,CADD;AAKA;;;;EAnDgBP,KAAK,CAACmC,S;;AAsDxB,eAAe9B,GAAf","sourcesContent":["import React from 'react';\r\nimport connect from '@vkontakte/vkui-connect';\r\nimport { View } from '@vkontakte/vkui';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport fetchJsonp from 'fetch-jsonp';\r\nimport Home from './panels/Home';\r\n\r\nclass App extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tactivePanel: 'home',\r\n\t\t\tfetchedUser: null,\r\n\t\t\tauthToken : null,\r\n\t\t\titems : []\r\n\t\t};\r\n\r\n\t\tthis.getItems = this.getItems.bind(this)\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tconnect.subscribe((e) => {\r\n\t\t\tswitch (e.detail.type) {\r\n\t\t\t\tcase 'VKWebAppGetUserInfoResult':\r\n\t\t\t\t\tthis.setState({ fetchedUser: e.detail.data });\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'VKWebAppAccessTokenReceived':\r\n\t\t\t\t\tthis.setState({ authToken : e.detail.data.access_token });\r\n\t\t\t\t\tthis.getItems()\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.log(e.detail.type);\r\n\t\t\t}\r\n\t\t});\r\n\t\tconnect.send('VKWebAppGetUserInfo', {});\r\n\t\tconnect.send(\"VKWebAppGetAuthToken\", {\"app_id\": 6906999, \"scope\": \"market\"});\r\n\t}\r\n\r\n\tgo = (e) => {\r\n\t\tthis.setState({ activePanel: e.currentTarget.dataset.to })\r\n\t};\r\n\r\n\tgetItems() {\r\n\t\tconst ownerId = 124527492\r\n\t\tlet api = `https://api.vk.com/method/market.get?v=5.52&access_token=${this.state.authToken}&owner_id=-${ownerId}`\r\n\t\tfetchJsonp(api)\r\n\t\t.then(res => res.json())\r\n\t\t.then(data => this.setState({ items : data.response.items}))\r\n\t\t.catch(e => [])\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<View activePanel={this.state.activePanel}>\r\n\t\t\t\t<Home id=\"home\" items={this.state.items} fetchedUser={this.state.fetchedUser} go={this.go} />\r\n\t\t\t</View>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}